<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Planejador de Independ√™ncia Financeira</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --primary:#2ecc71;
  --secondary:#34495e;
  --bg:#f4f6f8;
  --card:#ecf0f1;
}

body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: var(--bg);
  padding: 20px;
}

.container {
  max-width: 1200px;
  margin: auto;
  background: white;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,.08);
}

h1 {
  text-align: center;
  color: var(--secondary);
}

h2 {
  margin-top: 30px;
  color: var(--secondary);
  border-left: 5px solid var(--primary);
  padding-left: 10px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
  gap: 15px;
  margin-top: 15px;
}

label {
  font-weight: 600;
  font-size: 14px;
  color: #555;
}

input {
  width: 100%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

input:focus {
  outline: none;
  border-color: var(--primary);
}

button {
  margin-top: 30px;
  padding: 14px;
  width: 100%;
  font-size: 17px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

button:hover {
  background: #27ae60;
}

.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
  gap: 15px;
  margin-top: 25px;
}

.card {
  background: var(--card);
  padding: 20px;
  border-radius: 10px;
  text-align: center;
}

.card h3 {
  margin-bottom: 8px;
}

canvas {
  margin-top: 35px;
}
</style>
</head>

<body>

<div class="container">

<h1>Planejador de Independ√™ncia Financeira</h1>

<h2>Par√¢metros Principais</h2>
<div class="grid">
  <div>
    <label>Patrim√¥nio Livre Atual</label>
    <input id="patrimonio" type="text" value="100.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Aporte Mensal Livre</label>
    <input id="aporte" type="text" value="3.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Anos de Acumula√ß√£o</label>
    <input id="anos" type="number" value="30">
  </div>

  <div>
    <label>Saque Mensal no Usufruto</label>
    <input id="saque" type="text" value="8.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Anos de Usufruto</label>
    <input id="anosUsu" type="number" value="35">
  </div>

  <div>
    <label>Retorno Real da Carteira (%)</label>
    <input id="retorno" type="number" value="7">
  </div>
</div>

<h2>Balde Previd√™ncia & FGTS</h2>
<div class="grid">
  <div>
    <label>Saldo Previd√™ncia</label>
    <input id="prevSaldo" type="text" value="80.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Aporte Mensal Previd√™ncia</label>
    <input id="prevAporte" type="text" value="1.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Retorno Previd√™ncia (%)</label>
    <input id="prevRet" type="number" value="6">
  </div>

  <div>
    <label>Saldo FGTS</label>
    <input id="fgtsSaldo" type="text" value="50.000,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Aporte Mensal FGTS</label>
    <input id="fgtsAporte" type="text" value="0,00" oninput="formatarMoedaBR(this)">
  </div>

  <div>
    <label>Retorno FGTS (%)</label>
    <input id="fgtsRet" type="number" value="3">
  </div>
</div>

<label style="margin-top:15px; display:block;">
  <input type="checkbox" id="usarAlternativos" checked>
  Usar Previd√™ncia e FGTS no Usufruto
</label>

<button onclick="simular()">Simular Planejamento</button>

<div class="cards">
  <div class="card" id="cardLivre"></div>
  <div class="card" id="cardPrev"></div>
  <div class="card" id="cardFgts"></div>
</div>

<canvas id="grafico"></canvas>

</div>

<script>
let chart;

/* ===== M√ÅSCARA DE MOEDA ===== */
function formatarMoedaBR(input) {
  let valor = input.value.replace(/\D/g, "");
  valor = (valor / 100).toFixed(2);
  valor = valor.replace(".", ",");
  valor = valor.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  input.value = valor;
}

function moedaParaNumero(valor) {
  if (!valor) return 0;
  return Number(valor.replace(/\./g, "").replace(",", "."));
}

/* ===== SIMULA√á√ÉO ===== */
function simular() {

  let patrimonio = moedaParaNumero(document.getElementById("patrimonio").value);
  let aporte = moedaParaNumero(document.getElementById("aporte").value);
  let anosAcc = Number(document.getElementById("anos").value);
  let saque = moedaParaNumero(document.getElementById("saque").value);
  let anosUsu = Number(document.getElementById("anosUsu").value);
  let retorno = Number(document.getElementById("retorno").value) / 100;

  let prev = moedaParaNumero(document.getElementById("prevSaldo").value);
  let prevAporte = moedaParaNumero(document.getElementById("prevAporte").value);
  let prevRet = Number(document.getElementById("prevRet").value) / 100;

  let fgts = moedaParaNumero(document.getElementById("fgtsSaldo").value);
  let fgtsAporte = moedaParaNumero(document.getElementById("fgtsAporte").value);
  let fgtsRet = Number(document.getElementById("fgtsRet").value) / 100;

  let usarAlt = document.getElementById("usarAlternativos").checked;

  let labels = [];
  let dados = [];

  /* ACUMULA√á√ÉO */
  for (let a = 1; a <= anosAcc; a++) {
    patrimonio = patrimonio * (1 + retorno) + aporte * 12;
    prev = prev * (1 + prevRet) + prevAporte * 12;
    fgts = fgts * (1 + fgtsRet) + fgtsAporte * 12;

    labels.push("Ano " + a);
    dados.push(patrimonio);
  }

  /* USUFRUTO */
  let totalUsufruto = patrimonio + (usarAlt ? prev + fgts : 0);

  for (let u = 1; u <= anosUsu; u++) {
    totalUsufruto = totalUsufruto * (1 + retorno) - saque * 12;
    labels.push("U " + u);
    dados.push(totalUsufruto);
    if (totalUsufruto <= 0) break;
  }

  document.getElementById("cardLivre").innerHTML =
    `<h3>ü™£ Patrim√¥nio Livre</h3><p><strong>R$ ${patrimonio.toLocaleString("pt-BR")}</strong></p>`;

  document.getElementById("cardPrev").innerHTML =
    `<h3>ü™£ Previd√™ncia</h3><p><strong>R$ ${prev.toLocaleString("pt-BR")}</strong></p>`;

  document.getElementById("cardFgts").innerHTML =
    `<h3>ü™£ FGTS</h3><p><strong>R$ ${fgts.toLocaleString("pt-BR")}</strong></p>`;

  renderGrafico(labels, dados);
}

/* ===== GR√ÅFICO ===== */
function renderGrafico(labels, dados) {
  if (chart) chart.destroy();
  chart = new Chart(document.getElementById("grafico"), {
    type: "line",
    data: {
      labels,
      datasets: [{
        label: "Evolu√ß√£o do Patrim√¥nio Total",
        data: dados,
        borderWidth: 3
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: "bottom" }
      }
    }
  });
}
</script>

</body>
</html>
